function acessaAjax(method,type,url,obj,opmsg){if(method.indexOf(":")>-1){method=method.split(":");var vescape=(typeof(method[2])!="undefined"&&typeof(method[2])!="unknown"&&method[2].indexOf("NOESCAPE")!=-1)?false:true;var form=getElement(method[1]);var method=method[0];}else{var form="";}
var type=type;var xmlDoc=null;if(obj.indexOf(":")>-1){obj=obj.split(":");var objReturnAux=getElement(obj[0]);var objReturnSet=getElement(obj[1]);}else{var objReturnAux;var objReturnSet=getElement(obj);}
if(objReturnSet){var param=(method=="GET")?null:null;var url=(url.indexOf("#")!=-1)?url.replace("#",""):url;var httpRequest=loadXMLDoc();if(httpRequest){httpRequest.open(method.toLowerCase(),url,true);if(method=="POST"){if(httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded")){alert("Não foi possível definir o tipo do cabeçalho para o método desejado.");}
if(httpRequest.setRequestHeader("Control","no-cache")){alert("Não foi possível definir o tipo do controle para o método desejado.");}var param=getForm(form,vescape);} httpRequest.onreadystatechange=function(){if(httpRequest.readyState==4){if(httpRequest.status==200){if(type=="xml"){if(window.XMLHttpRequest){if(httpRequest.overrideMimeType){httpRequest.overrideMimeType("text/xml");}else{alert("Não foi possível realizar as atribuições para o XML");return false;}}
xmlDoc=httpRequest.responseXML;alert("Consultas XML estão desativadas.");return false;}else{xmlDoc=httpRequest.responseText;}xmlDoc=xmlDoc.replace(/\+/g," ");xmlDoc=unescape(xmlDoc);printMensg(objReturnSet,xmlDoc);if(typeof(objReturnAux)!="undefined"){if(typeof(objReturnValue)!="undefined"){printMensg(objReturnAux,objReturnValue);}}}else{objReturn=(typeof(objReturnAux)!="undefined")?objReturnAux:objReturnSet;if(typeof(objReturnValue)!="undefined"){printMensg(objReturn,objReturnValue);}
printMensg(null,"Houve um problema ao obter os dados:\n"+httpRequest.statusText);}}else if(httpRequest.readyState==1){objReturn=(typeof(objReturnAux)!="undefined")?objReturnAux:objReturnSet;objReturnValue=objReturn.innerHTML;if(opmsg!=0){printMensg(objReturn,aguardeMsg(opmsg));}}}
if(param!=null) var param=param.replace(/\+/g," ");httpRequest.send(param);}else{alert("Não foi possível fazer a requisição da consulta no sistema.");}}else{printMensg(null,"Atenção, nenhum objeto foi definido para receber as informações.");}}
function loadXMLDoc(){if(window.XMLHttpRequest){httpRequest=new XMLHttpRequest();}else if(window.ActiveXObject){try{httpRequest=new ActiveXObject("Msxml2.XMLHTTP.4.0");}catch(e){try{httpRequest=new ActiveXObject("Msxml2.XMLHTTP.3.0");}catch(e){try{httpRequest=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){try{httpRequest=new ActiveXObject("Microsoft.XMLHTTP");}catch(e){httpRequest=false;}}}}}
return httpRequest?httpRequest:false;} function getElement(obj){if(typeof(obj)=="string"){objRetun=window.document.getElementById(obj);if(objRetun==null)
objRetun=window.parent.document.getElementById(obj);} if(objRetun==null){return false;}else return objRetun;} function addEvent(obj,evType,fn){if(obj.addEventListener) obj.addEventListener(evType,fn,true) 
if(obj.attachEvent) obj.attachEvent("on"+evType,fn)}function getForm(obj,vescape){var getstr="";for(i=0;i<obj.elements.length;i++){var element=obj.elements[i];var tipo_element=element.type;var cont_index=0;name=value=null;switch(tipo_element){case"password":var name=element.name;var value=element.value;break;case"text":var name=element.name;var value=element.value;break;case"textarea":var name=element.name;var value=element.value;break;case"hidden":var name=element.name;var value=element.value;break;case"checkbox":if(element.checked){var name=element.name;var value=element.value;}
break;case"radio":if(element.checked){var name=element.name;var value=element.value;}break;case"select-one":var sel=element;var name=element.name;var value=sel.options[sel.selectedIndex].value;break;case"select-multiple":var name=element.name;var value=new Array();for(sm=0;sm<element.length;sm++){if(element.options[sm].selected==true){value[cont_index]=element.options[sm].value;cont_index++;}}
break;case"file":var name=element.name;var value=element.value;break;case"button":var name=element.name;var value=element.value;break;}if(name!=null){if(cont_index<=0){value=vescape==true?escape(value):value;getstr+=name+"="+value+"&";}else{for(cont_i=0;cont_i<cont_index;cont_i++){nvalue=vescape==true?escape(value[cont_i]):value[cont_i];getstr+=name+"[]="+nvalue+"&";}}}}
getstr=getstr.substring(0,(getstr.length-1));return getstr;} function setScript(texto,obj){var ini,pos_src,fim,codigo;var objScript=null;ini=texto.indexOf("<script",0)
while(ini!=-1){var objScript=document.createElement("script");pos_src=texto.indexOf(" src",ini) 
ini=texto.indexOf(">",ini)+1;if(pos_src<ini&&pos_src>=0){ini=pos_src+4;fim=texto.indexOf(".",ini)+4;codigo=texto.substring(ini,fim);codigo=codigo.replace("=","").replace(" ","").replace("\"","").replace("\"","").replace("\"","").replace("\"","").replace(">","");objScript.src=codigo;}else{fim=texto.indexOf("</script>",ini);codigo=texto.substring(ini,fim);objScript.text=codigo;}
obj.appendChild(objScript);ini=texto.indexOf("<script",fim);objScript=null;}} function setSizeIframe(){if(typeof(window.parent.document.getElementById("ifrLoad"))=="object"){iframe=window.parent.document.getElementById("ifrLoad");if(iframe!=null){if(typeof(window.document.getElementById("tblLoad"))=="object"){tabela=window.document.getElementById("tblLoad");if(tabela!=null){aux=iframe;while(aux.nodeName.toLowerCase()!="td"){if(navigator.appName=="Netscape")
aux=aux.parentNode;else aux=aux.parentElement;}iframe.height=0;iframe.height=tabela.offsetHeight;iframe.width=aux.offsetWidth;tabela.width=aux.offsetWidth;}}}}}
addEvent(window,"load",setSizeIframe);function extraiScript(texto){var ini=0;while(ini!=-1){ini=texto.indexOf('<script',ini);if(ini>=0){ini=texto.indexOf('>',ini)+1;var fim=texto.indexOf('</script>',ini);codigo=texto.substring(ini,fim);novo=document.createElement("script")
novo.text=codigo;document.body.appendChild(novo);}}}function aguardeMsg(opcao){switch(opcao){case 1:msg="<div id=\"Aguarde\">Aguarde, importando as informações.</div>";break;case 2:msg="<div id=\"Aguardando\"> </div>";break;case 3:msg="<div> </div>";break;case 4:msg="<div id=\"AguardeMinimo\"></div>";break;case 5:msg="<div id=\"AguardeLine\"></div>";break;case 6:msg="<div id=\"AguardeRanking\"></div>";break;default:msg="<span>      </span>";break;}
return msg;}function printMensg(obj,mensg){if(typeof(obj)!="undefined"&&obj!=null){obj=new Object(obj);if(obj.nodeName.indexOf("SELECT")!=-1){for(i=obj.length;i>=0;i--){obj.options[i]=null;}objdiv=new Object();objdiv=window.document.createElement("div");objdiv.innerHTML=mensg.replace(/<option/g,"<span").replace(/<\/option/g,"</span").replace(/value=/g,"title=");contChild=objdiv.childNodes.length;if(typeof(objdiv.childNodes[contChild-1].innerHTML)=="undefined"){objdiv.removeChild(objdiv.childNodes[contChild-1]);contChild=contChild-1;}contChild=objdiv.childNodes.length;contElement=0;selectElement=0;textElement=objdiv.childNodes[0].innerHTML;for(i=0;i<contChild;i++){if(objdiv.childNodes[i].nodeName.indexOf("SPAN")!=-1){text=objdiv.childNodes[i].innerHTML;value=objdiv.childNodes[i].getAttribute("title");cont_attr=objdiv.childNodes[i].attributes;if(contChild==1||contChild>1){for(attr=0;attr<cont_attr.length;attr++)selectElement=(cont_attr[attr].nodeName.toLowerCase()=="selected")?contElement:selectElement;obj.options[contElement]=new Option(text,value);obj.disabled=true;contElement++;}}}if(typeof(httpRequest.status)!="undefined"&&typeof(httpRequest.status)!="unknown")if(httpRequest.status==200){if(contElement>1)obj.disabled=false;obj.options[selectElement].selected=true;}if(objdiv){delete objdiv;}}else{obj.innerHTML=mensg;setScript(mensg,obj);}}else{alert(mensg);return false;}}